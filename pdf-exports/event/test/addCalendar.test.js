import fs from 'node:fs';
import PDFDocument from 'pdfkit';
import addCalendar from '../lib/addCalendar.js';

function addRectangle(doc, cursor, width, height, color) {
  doc.fillColor(color).rect(cursor.x, cursor.y, width, height).fill();
}

const { PDF_TEST_FOLDER: pdfTestFolder = '/tmp' } = process.env;

const doc = new PDFDocument({ size: 'A4', margin: 0 });
const writeStream = fs.createWriteStream(`${pdfTestFolder}/addCalendar.pdf`);
doc.pipe(writeStream);

const lang = "fr";

const cursor = { x: 0, y: 0 };

const timings = {
  availableSpace: doc.page.width,
  columnNumber: 3,
  data: [
    {
      begin: '2024-06-01T14:00:00+02:00',
      end: '2024-06-01T16:00:00+02:00'
    },
    {
      begin: '2024-06-03T14:00:00+02:00',
      end: '2024-06-03T16:00:00+02:00'
    },
    {
      begin: '2024-06-08T14:00:00+02:00',
      end: '2024-06-08T16:00:00+02:00'
    },
    {
      begin: '2024-06-10T14:00:00+02:00',
      end: '2024-06-10T16:00:00+02:00'
    },
    {
      begin: '2024-06-11T14:00:00+02:00',
      end: '2024-06-11T16:00:00+02:00'
    },
    {
      begin: '2024-06-12T14:00:00+02:00',
      end: '2024-06-12T16:00:00+02:00'
    },
    {
      begin: '2024-07-13T14:00:00+02:00',
      end: '2024-07-13T16:00:00+02:00'
    },
    {
      begin: '2024-07-15T14:00:00+02:00',
      end: '2024-07-15T16:00:00+02:00'
    },
    {
      begin: '2024-07-16T14:00:00+02:00',
      end: '2024-07-16T16:00:00+02:00'
    },
    {
      begin: '2024-07-17T14:00:00+02:00',
      end: '2024-07-17T16:00:00+02:00'
    },
    {
      begin: '2024-08-01T14:00:00+02:00',
      end: '2024-08-01T16:00:00+02:00'
    },
    {
      begin: '2024-08-02T14:00:00+02:00',
      end: '2024-08-02T16:00:00+02:00'
    },
    {
      begin: '2024-08-03T14:00:00+02:00',
      end: '2024-08-03T16:00:00+02:00'
    },
    {
      begin: '2024-09-12T14:00:00+02:00',
      end: '2024-09-12T16:00:00+02:00'
    },
    {
      begin: '2024-09-13T14:00:00+02:00',
      end: '2024-09-13T16:00:00+02:00'
    },
    {
      begin: '2024-09-14T14:00:00+02:00',
      end: '2024-09-14T16:00:00+02:00'
    },
    {
      begin: '2024-09-16T14:00:00+02:00',
      end: '2024-09-16T16:00:00+02:00'
    },
    {
      begin: '2024-09-17T14:00:00+02:00',
      end: '2024-09-17T16:00:00+02:00'
    },
    {
      begin: '2024-09-18T14:00:00+02:00',
      end: '2024-09-18T16:00:00+02:00'
    },
    {
      begin: '2024-09-19T14:00:00+02:00',
      end: '2024-09-19T16:00:00+02:00'
    },
    {
      begin: '2024-09-20T14:00:00+02:00',
      end: '2024-09-20T16:00:00+02:00'
    },
    {
      begin: '2024-09-21T14:00:00+02:00',
      end: '2024-09-21T16:00:00+02:00'
    },
    {
      begin: '2024-09-23T14:00:00+02:00',
      end: '2024-09-23T16:00:00+02:00'
    },
    {
      begin: '2024-09-24T14:00:00+02:00',
      end: '2024-09-24T16:00:00+02:00'
    },
    {
      begin: '2024-09-25T14:00:00+02:00',
      end: '2024-09-25T16:00:00+02:00'
    },
    {
      begin: '2024-09-26T14:00:00+02:00',
      end: '2024-09-26T16:00:00+02:00'
    },
    {
      begin: '2024-09-27T14:00:00+02:00',
      end: '2024-09-27T16:00:00+02:00'
    },
    {
      begin: '2024-09-28T14:00:00+02:00',
      end: '2024-09-28T16:00:00+02:00'
    },
    {
      begin: '2024-09-30T14:00:00+02:00',
      end: '2024-09-30T16:00:00+02:00'
    },
    {
      begin: '2024-10-25T14:00:00+02:00',
      end: '2024-10-25T16:00:00+02:00'
    },
    {
      begin: '2024-10-26T14:00:00+02:00',
      end: '2024-10-26T16:00:00+02:00'
    },
    {
      begin: '2024-10-28T14:00:00+02:00',
      end: '2024-10-28T16:00:00+02:00'
    },
    {
      begin: '2024-10-29T14:00:00+02:00',
      end: '2024-10-29T16:00:00+02:00'
    },
    {
      begin: '2024-10-30T14:00:00+02:00',
      end: '2024-10-30T16:00:00+02:00'
    },
    {
      begin: '2024-11-01T14:00:00+02:00',
      end: '2024-11-01T16:00:00+02:00'
    },
    {
      begin: '2024-11-02T14:00:00+02:00',
      end: '2024-11-02T16:00:00+02:00'
    },
    {
      begin: '2024-11-04T14:00:00+02:00',
      end: '2024-11-04T16:00:00+02:00'
    },
    {
      begin: '2024-11-05T14:00:00+02:00',
      end: '2024-11-05T16:00:00+02:00'
    },
    {
      begin: '2024-11-06T14:00:00+02:00',
      end: '2024-11-06T16:00:00+02:00'
    },
    {
      begin: '2024-11-07T14:00:00+02:00',
      end: '2024-11-07T16:00:00+02:00'
    },
    {
      begin: '2024-11-08T14:00:00+02:00',
      end: '2024-11-08T16:00:00+02:00'
    },
    {
      begin: '2024-11-09T14:00:00+02:00',
      end: '2024-11-09T16:00:00+02:00'
    },
    {
      begin: '2024-11-11T14:00:00+02:00',
      end: '2024-11-11T16:00:00+02:00'
    },
    {
      begin: '2024-11-12T14:00:00+02:00',
      end: '2024-11-12T16:00:00+02:00'
    },
    {
      begin: '2024-11-13T14:00:00+02:00',
      end: '2024-11-13T16:00:00+02:00'
    },
    {
      begin: '2024-11-14T14:00:00+02:00',
      end: '2024-11-14T16:00:00+02:00'
    },
    {
      begin: '2024-11-15T14:00:00+02:00',
      end: '2024-11-15T16:00:00+02:00'
    },
    {
      begin: '2024-11-16T14:00:00+02:00',
      end: '2024-11-16T16:00:00+02:00'
    },
    {
      begin: '2024-11-27T14:00:00+02:00',
      end: '2024-11-27T16:00:00+02:00'
    },
    {
      begin: '2024-11-28T14:00:00+02:00',
      end: '2024-11-28T16:00:00+02:00'
    },
    {
      begin: '2024-11-29T14:00:00+02:00',
      end: '2024-11-29T16:00:00+02:00'
    },
    {
      begin: '2024-11-30T14:00:00+02:00',
      end: '2024-11-30T16:00:00+02:00'
    },
    {
      begin: '2024-12-27T14:00:00+02:00',
      end: '2024-12-27T16:00:00+02:00'
    },
    {
      begin: '2024-12-28T14:00:00+02:00',
      end: '2024-12-28T16:00:00+02:00'
    },
    {
      begin: '2024-12-30T14:00:00+02:00',
      end: '2024-12-30T16:00:00+02:00'
    }
  ]
};


const width = doc.page.width;
// const columnNumber = 3
let height = cursor.y + 100;
// let height = doc.page.height;

addRectangle(doc, cursor, width, height, 'yellow');
await addCalendar(doc, cursor, { content: timings.data, width, columnNumber: timings.columnNumber, height, lang })

doc.end();
