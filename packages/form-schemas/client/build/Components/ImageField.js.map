{"version":3,"file":"ImageField.js","names":["Dropzone","Component","multilingualLabels","flattenLabels","storePaths","extensionsToAccept","jsxDEV","_jsxDEV","ImageField","constructor","props","field","store","filename","_get","state","preview","join","onDrop","bind","onRemove","onChange","setState","acceptedFiles","files","map","file","Object","assign","_URL","createObjectURL","originalName","render","lang","value","labels","name","extensions","className","children","disabled","enable","accept","multiple","_ref","getRootProps","getInputProps","_objectSpread","fileName","_jsxFileName","lineNumber","columnNumber","type","update","alt","src","upload","acceptedExtensions","concat","onClick","title","remove"],"sources":["../../src/Components/ImageField.js"],"sourcesContent":["import _ from 'lodash';\nimport Dropzone from '@openagenda/react-dropzone';\nimport { Component } from 'react';\n\nimport multilingualLabels from '@openagenda/labels/form-schemas/imageUpload.js';\nimport flattenLabels from '@openagenda/labels/flatten.js';\n\nimport storePaths from '../lib/storePaths.js';\nimport extensionsToAccept from '../lib/extensionsToAccept.js';\n\nexport default class ImageField extends Component {\n  constructor(props) {\n    super(props);\n\n    const {\n      field: { store },\n    } = this.props;\n\n    const filename = _.get(this.props, 'value.filename');\n\n    this.state = {\n      preview: filename ? [storePaths(store), filename].join('/') : null,\n    };\n\n    this.onDrop = this.onDrop.bind(this);\n    this.onRemove = this.onRemove.bind(this);\n  }\n\n  onRemove() {\n    const { onChange } = this.props;\n\n    this.setState({\n      preview: null,\n    });\n\n    onChange(null);\n  }\n\n  onDrop(acceptedFiles) {\n    const { onChange } = this.props;\n\n    const files = acceptedFiles.map((file) =>\n      Object.assign(file, {\n        preview: URL.createObjectURL(file),\n      }));\n\n    this.setState({\n      preview: _.get(files, '0.preview'),\n    });\n\n    onChange(\n      {\n        originalName: _.get(files, '0.name'),\n      },\n      files,\n    );\n  }\n\n  render() {\n    const { lang, field, value } = this.props;\n\n    const labels = flattenLabels(multilingualLabels, lang, true);\n\n    const { field: name, extensions } = field;\n\n    const { preview } = this.state;\n\n    return (\n      <div className=\"file-upload\">\n        <Dropzone\n          disabled={field.enable === false}\n          accept={extensionsToAccept(extensions)}\n          multiple={false}\n          name={name}\n          onDrop={this.onDrop}\n        >\n          {({ getRootProps, getInputProps }) => (\n            <div\n              className={\n                preview ? 'file-dropzone image-preview' : 'file-dropzone'\n              }\n              {...getRootProps()}\n            >\n              <input {...getInputProps()} />\n              {preview && (\n                <div className=\"center-button margin-bottom-sm\">\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-primary margin-all-sm\"\n                  >\n                    {labels.update}\n                  </button>\n                </div>\n              )}\n              {preview && (\n                <img alt=\"\" className=\"padding-all-sm\" src={preview} />\n              )}\n              {!preview && (\n                <div className=\"center-button margin-bottom-sm\">\n                  <button type=\"button\" className=\"btn btn-primary\">\n                    {labels.upload}\n                  </button>\n                </div>\n              )}\n              <span className=\"accepted-image-info\">\n                {labels.acceptedExtensions}:&nbsp; .\n                {[].concat(extensions).join(', .')}\n              </span>\n            </div>\n          )}\n        </Dropzone>\n        {value ? (\n          <button\n            type=\"button\"\n            onClick={this.onRemove}\n            className=\"btn btn-danger margin-all-sm remove-file\"\n            title={labels.remove}\n            aria-label={labels.remove}\n          >\n            <i className=\"fa fa-trash\" />\n          </button>\n        ) : null}\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}