{"version":3,"file":"SelectField.js","names":["useState","useCallback","ReactSelectInput","classNames","labels","flattenLabels","jsxDEV","_jsxDEV","getSelectOptions","field","opts","arguments","length","undefined","value","options","filter","o","_context","_context2","display","_includesInstanceProperty","call","concat","id","map","label","info","getCurrentValue","_ref","isFresh","default","Option","props","className","cx","getStyles","isDisabled","isFocused","isSelected","innerRef","innerProps","data","_objectSpread","style","option","ref","children","fileName","_jsxFileName","lineNumber","columnNumber","SelectField","onChange","propsOnChange","lang","isMulti","setIsFresh","selected","noOption","selectPlaceholder","defaultSelectPlaceholder","isClearable","optional","noOptionsMessage","components","placeholder"],"sources":["../../src/Components/SelectField.js"],"sourcesContent":["import { useState, useCallback } from 'react';\nimport { ReactSelectInput } from '@openagenda/react-shared';\nimport classNames from 'classnames';\n\nimport labels from '@openagenda/labels/form-schemas/index.js';\nimport flattenLabels from '@openagenda/labels/flatten.js';\n\nconst getSelectOptions = (field, opts = {}) => {\n  const { value } = opts;\n  const { options } = field;\n\n  return options\n    .filter((o) => {\n      if (!o.display) {\n        return false;\n      }\n      if ([undefined, null].includes(value)) {\n        return true;\n      }\n      return [].concat(value).includes(o.id);\n    })\n    .map((o) => ({\n      value: o.id,\n      label: o.label,\n      info: o.info,\n    }));\n};\n\nconst getCurrentValue = ({ isFresh, field, value }) => {\n  if (value) {\n    return getSelectOptions(field, { value });\n  }\n\n  if (isFresh && field.default !== undefined) {\n    return getSelectOptions(field, { value: field.default });\n  }\n};\n\nconst Option = (props) => {\n  const {\n    className,\n    cx,\n    getStyles,\n    isDisabled,\n    isFocused,\n    isSelected,\n    innerRef,\n    innerProps,\n    data,\n  } = props;\n\n  const { label, info } = data;\n\n  return (\n    <div\n      style={getStyles('option', props)}\n      className={cx(\n        {\n          option: true,\n          'option--is-disabled': isDisabled,\n          'option--is-focused': isFocused,\n          'option--is-selected': isSelected,\n        },\n        className,\n      )}\n      ref={innerRef}\n      aria-disabled={isDisabled}\n      {...innerProps}\n    >\n      <div>{label}</div>\n      {info && (\n        <div className={classNames({ 'text-muted': !isSelected })}>{info}</div>\n      )}\n    </div>\n  );\n};\n\nexport default function SelectField(props) {\n  const { onChange: propsOnChange, field, value, lang, isMulti } = props;\n\n  const [isFresh, setIsFresh] = useState(true);\n\n  const onChange = useCallback(\n    (selected) => {\n      setIsFresh(false);\n\n      if (selected === null) {\n        propsOnChange(isMulti ? [] : undefined);\n        return;\n      }\n\n      propsOnChange(isMulti ? selected.map((o) => o.value) : selected.value);\n    },\n    [propsOnChange, isMulti],\n  );\n\n  const { noOption, selectPlaceholder: defaultSelectPlaceholder } = flattenLabels(labels, lang);\n\n  return (\n    <ReactSelectInput\n      value={getCurrentValue({ isFresh, field, value })}\n      options={getSelectOptions(field)}\n      onChange={onChange}\n      isClearable={!isMulti && field.optional}\n      noOptionsMessage={() => noOption}\n      isMulti={isMulti}\n      components={{ Option }}\n      placeholder={field.placeholder || defaultSelectPlaceholder}\n    />\n  );\n}\n"],"mappings":"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","ignoreList":[]}