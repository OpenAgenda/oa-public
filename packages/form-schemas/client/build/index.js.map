{"version":3,"file":"index.js","names":["debug","ih","Component","flushSync","classNames","formSchemaLabels","errorLabels","flattenLabels","Spinner","LeaveWarningPrompt","FormSchema","getErrorLabel","submit","isItemDisplayed","Section","Field","jsxDEV","_jsxDEV","log","FormSchemaComponent","constructor","props","lang","values","withErrors","labels","stateless","sanitize","bind","onChange","init","errors","_assign","_get","main","defaultLabelLanguage","loading","state","onSubmit","onSubmitConfirm","sanitized","length","set","e","options","arguments","undefined","preventDefault","res","method","unloadWarning","enableUnloadWarning","onSubmitSuccess","draft","get","clean","_keys","Object","keys","p","_objectSpread","files","_Promise","then","setState","unloadWarningEnabled","formSchema","_getFormSchema","response","statusCode","onServerError","submitted","globalError","catch","errorResponse","Array","isArray","onServerException","maxFileSize","globalErrorPath","replace","window","location","href","redirect","fieldName","value","_context2","field","getField","currentValues","getCurrentValues","updateValues","$set","relatedFields","getRelatedFields","relatedFieldNames","map","f","updatedErrors","filter","_context","_includesInstanceProperty","concat","call","getFieldErrors","isFileField","getFileFields","currentFiles","filesUpdate","$unset","forEach","relatedField","keepFields","fieldErrors","defaultValue","update","schema","hasChanged","memoizeKey","memoized","hash","validate","getValidate","Error","label","fieldLabel","renderGroupedErrors","matching","_first","a","position","ErrorComponent","global","fileName","_jsxFileName","lineNumber","columnNumber","className","children","groupErrorHeader","_e$lang","htmlFor","code","toUpperCase","renderBottomActions","onCancel","BottomActionsComponent","style","type","onClick","cancel","mode","disabled","renderUnloadWarning","warnBeforePageUnload","page","warnBeforeRouteTransition","router","enabled","render","propsClassNames","components","role","cleanValues","confirmation","done","getFields","_errors$filter$shift","section","customComponents","fieldType","relatedValues","_pick","rf","error","shift"],"sources":["../src/index.js"],"sourcesContent":["import _ from 'lodash';\nimport debug from 'debug';\nimport ih from 'immutability-helper';\nimport { Component } from 'react';\nimport { flushSync } from 'react-dom';\nimport classNames from 'classnames';\n\nimport formSchemaLabels from '@openagenda/labels/form-schemas/index.js';\n\nimport errorLabels from '@openagenda/labels/errors/index.js';\nimport flattenLabels from '@openagenda/labels/flatten.js';\nimport { Spinner, LeaveWarningPrompt } from '@openagenda/react-shared';\n\nimport FormSchema from './iso/FormSchema.js';\nimport getErrorLabel from './iso/getErrorLabel.js';\n\nimport submit from './lib/submit.js';\nimport isItemDisplayed from './lib/isItemDisplayed.js';\nimport Section from './Components/Section.js';\nimport Field from './Components/Field.js';\n\nconst log = debug('FormSchemaComponent');\n\nexport default class FormSchemaComponent extends Component {\n  constructor(props) {\n    super(props);\n\n    const { lang, values, withErrors, labels, stateless } = props;\n\n    this.sanitize = this.sanitize.bind(this);\n    this.onChange = this.onChange.bind(this);\n\n    const init = {\n      labels: {\n        errors: flattenLabels(\n          _.assign({}, errorLabels, _.get(labels, 'errors', {})),\n          lang,\n          true,\n        ),\n        main: flattenLabels(formSchemaLabels, lang, true),\n      },\n      defaultLabelLanguage: lang,\n    };\n\n    if (!stateless) {\n      init.values = values;\n      init.errors = [];\n      init.loading = false;\n    }\n\n    this.state = init;\n\n    this.onSubmit = this.onSubmit.bind(this);\n    this.onSubmitConfirm = this.onSubmitConfirm.bind(this);\n\n    const sanitized = this.sanitize(values);\n\n    // display of errors at load\n    const { errors } = withErrors ? sanitized : { errors: [] };\n\n    if (errors && !stateless) {\n      this.state.errors = errors;\n    } else if (errors && errors.length) {\n      this.set({ errors });\n    }\n  }\n\n  onSubmit(e, options = {}) {\n    if (e) e.preventDefault();\n\n    const {\n      res,\n      method,\n      onSubmit,\n      unloadWarning: enableUnloadWarning,\n      onSubmitSuccess,\n    } = this.props;\n\n    const { draft = undefined } = options;\n\n    const values = this.get('values');\n\n    const { clean, errors } = this.sanitize(values, { draft });\n\n    if (_.keys(errors).length) {\n      log('%s errors at submission attempt', Object.keys(errors).length);\n      return this.set({ errors });\n    }\n\n    if (onSubmit) {\n      const p = onSubmit({\n        values: draft !== undefined ? { ...values, draft } : values,\n        clean,\n        files: this.get('files'),\n      });\n\n      if (p instanceof Promise && enableUnloadWarning) {\n        p.then(() => {\n          flushSync(() => {\n            this.setState({ unloadWarningEnabled: false });\n          });\n        });\n      } else if (enableUnloadWarning) {\n        flushSync(() => {\n          this.setState({ unloadWarningEnabled: false });\n        });\n      }\n      return;\n    }\n\n    this.set({\n      loading: true,\n    });\n\n    submit({\n      method,\n      res: _.get(res, method, ''),\n      formSchema: this._getFormSchema(),\n      values: draft !== undefined ? { ...values, draft } : values, // values can be clean anew once received by server\n      files: this.get('files'),\n    })\n      .then((response) => {\n        if (response.statusCode !== 200) {\n          this.onServerError(response);\n          return;\n        }\n\n        if (enableUnloadWarning) {\n          flushSync(() => {\n            this.setState({ unloadWarningEnabled: false });\n          });\n        }\n\n        if (onSubmitSuccess) {\n          onSubmitSuccess(this.get('values'), response);\n        } else {\n          this.set({\n            submitted: true,\n            globalError: null,\n            errors: [],\n            loading: false,\n          });\n        }\n      })\n      .catch((errorResponse) => this.onServerError(errorResponse));\n  }\n\n  onServerError(res) {\n    const errors = _.get(res, 'body.errors');\n\n    if (Array.isArray(errors) && errors.length) {\n      this.set({\n        globalError: null,\n        errors,\n        loading: false,\n      });\n    } else {\n      this.onServerException(res);\n    }\n  }\n\n  onServerException(res) {\n    const { maxFileSize } = this.props;\n\n    let globalErrorPath = 'state.labels.errors.serverException';\n\n    if (res.statusCode === 413) {\n      globalErrorPath = 'state.labels.errors.serverErrorTooLargeFile';\n    }\n\n    this.set({\n      globalError: _.get(this, globalErrorPath).replace(\n        '%max%',\n        maxFileSize || 22,\n      ),\n      loading: false,\n    });\n  }\n\n  onSubmitConfirm(e) {\n    const { res } = this.props;\n    e.preventDefault();\n\n    window.location.href = res.redirect;\n  }\n\n  onChange(fieldName, value, files) {\n    const { unloadWarning: enableUnloadWarning } = this.props;\n\n    log('onChange', fieldName, value, files);\n\n    const formSchema = this._getFormSchema();\n    const field = formSchema.getField(fieldName);\n    const currentValues = this.getCurrentValues();\n\n    const updateValues = {};\n\n    updateValues[fieldName] = { $set: value };\n\n    const relatedFields = formSchema.getRelatedFields(field);\n    const relatedFieldNames = relatedFields.map((f) => f.field);\n\n    const updatedErrors = this.get('errors', [])\n      .filter((e) => !relatedFieldNames.concat(fieldName).includes(e.field)) // keep other errors\n      .concat(this.getFieldErrors(field, value, relatedFields, currentValues));\n\n    log('onChange updating errors', updatedErrors);\n\n    const isFileField = formSchema\n      .getFileFields()\n      .map((f) => f.field)\n      .includes(fieldName);\n\n    const currentFiles = this.get('files', {});\n\n    const filesUpdate = {};\n\n    if (isFileField && value) {\n      filesUpdate[fieldName] = { $set: files };\n    } else if (isFileField) {\n      filesUpdate.$unset = [fieldName];\n    }\n\n    if (enableUnloadWarning) {\n      flushSync(() => {\n        this.setState({ unloadWarningEnabled: true });\n      });\n    }\n\n    this.set({\n      files: ih(currentFiles, filesUpdate),\n      values: ih(currentValues, updateValues),\n      errors: updatedErrors,\n    });\n  }\n\n  getFieldErrors(field, value, relatedFields = [], currentValues = {}) {\n    const values = {};\n\n    values[field.field] = value;\n\n    relatedFields.forEach((relatedField) => {\n      values[relatedField.field] = currentValues[relatedField.field];\n    });\n\n    const { errors } = this.sanitize(values);\n\n    const keepFields = relatedFields.map((f) => f.field).concat(field.field);\n\n    const fieldErrors = (errors || []).filter((e) =>\n      keepFields.includes(e.field));\n\n    log('getFieldErrors', { field, value, fieldErrors });\n\n    return fieldErrors;\n  }\n\n  getCurrentValues() {\n    return this.get('values', {}) || {};\n  }\n\n  get(field, defaultValue = null) {\n    const { stateless } = this.props;\n    return _.get(this, [stateless ? 'props' : 'state', field], defaultValue);\n  }\n\n  set(update) {\n    const { stateless, onChange } = this.props;\n    log('update', update);\n    if (!stateless) {\n      this.setState(update);\n    }\n\n    if (onChange) {\n      onChange(update);\n    }\n  }\n\n  _getFormSchema() {\n    const { schema, lang } = this.props;\n    // building the formSchema is a bit costly, so memoizition is useful here\n\n    const hasChanged = !!['hash', 'lang'].filter(\n      (memoizeKey) =>\n        _.get(this.memoized, memoizeKey, '')\n        !== _.get(this.props, memoizeKey, ''),\n    ).length;\n\n    if (hasChanged || !this.memoized) {\n      this.memoized = {\n        formSchema: new FormSchema(\n          ih(schema, {\n            defaultLabelLanguage: { $set: lang },\n          }),\n        ),\n        hash: _.get(this, 'props.hash', ''),\n        lang: _.get(this, 'props.lang', ''),\n      };\n    }\n\n    return this.memoized.formSchema;\n  }\n\n  sanitize(values, options) {\n    const { lang } = this.props;\n    const { labels } = this.state;\n    const formSchema = this._getFormSchema();\n    try {\n      // options may contain draft bool at true.\n      const validate = formSchema.getValidate(options);\n      const clean = validate(values);\n      return { clean, errors: [] };\n    } catch (errors) {\n      if (!Array.isArray(errors)) {\n        throw errors;\n      }\n\n      // simpler to always keep errors as arrays.\n      return {\n        clean: null,\n        errors: errors.map((e) => {\n          const field = formSchema.getField(e.field);\n          if (!field) {\n            throw new Error('did not find field matching validation error', e);\n          }\n\n          return ih(e, {\n            label: {\n              $set: getErrorLabel(labels.errors, field, e),\n            },\n            fieldLabel: {\n              $set: _.get(field.label, lang),\n            },\n          });\n        }),\n      };\n    }\n  }\n\n  renderGroupedErrors() {\n    const errors = this.get('errors', []);\n\n    const globalError = this.get('globalError');\n\n    if (!errors.length && !globalError) return null;\n\n    const matching = _.first(\n      _.get(this.props, 'errorComponents', []).filter(\n        (a) => a.position === 'bottom',\n      ),\n    );\n\n    if (matching) {\n      const { Component: ErrorComponent } = matching;\n\n      return <ErrorComponent errors={errors} global={globalError} />;\n    }\n\n    const { labels } = this.state;\n\n    return (\n      <div\n        className={\n          _.get(this.props, 'classNames.bottomErrorsCanvas')\n          || 'error-summary boxed padding-v-sm padding-h-sm margin-v-md'\n        }\n      >\n        {errors.length ? (\n          <div>\n            <div className=\"padding-bottom-sm\">\n              {labels.main.groupErrorHeader}:\n            </div>\n            <ul className=\"list-unstyled margin-left-xs\">\n              {errors.map((e) => (\n                <li key={`error-${e.field}-${e.lang ?? ''}-${e.code}`}>\n                  <label htmlFor={e.code}>\n                    {e.fieldLabel}\n                    {e.lang ? ` (${e.lang.toUpperCase()})` : ''}\n                  </label>\n                  :&nbsp;\n                  <span>{e.label}</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n        ) : null}\n        {globalError ? (\n          <div className=\"text-center padding-top-xs\">\n            <label htmlFor={globalError.code}>{globalError}</label>\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n\n  renderBottomActions() {\n    const { onCancel } = this.props;\n    const matching = _.first(\n      _.get(this.props, 'actionComponents', []).filter(\n        (a) => a.position === 'bottom',\n      ),\n    );\n\n    const loading = this.get('loading');\n\n    if (matching) {\n      const { Component: BottomActionsComponent } = matching;\n\n      return (\n        <BottomActionsComponent\n          onSubmit={this.onSubmit}\n          loading={loading}\n          sanitize={this.sanitize}\n        />\n      );\n    }\n\n    const { labels } = this.state;\n\n    return (\n      <div\n        style={{ position: 'relative' }}\n        className={\n          _.get(this.props, 'classNames.bottomActionsCanvas') || 'form-group'\n        }\n      >\n        {onCancel ? (\n          <button\n            type=\"button\"\n            className=\"btn btn-default\"\n            onClick={() => onCancel()}\n          >\n            {labels.main.cancel}\n          </button>\n        ) : null}\n        <div\n          className={classNames('margin-top-sm', { 'pull-right': onCancel })}\n        >\n          {loading && (\n            <span className=\"margin-left-sm\">\n              <Spinner mode=\"inline\" />\n            </span>\n          )}\n          <button\n            className={loading ? 'btn btn-default' : 'btn btn-primary'}\n            type=\"submit\"\n            disabled={loading}\n            onClick={this.onSubmit}\n          >\n            {labels.main.submit}\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  renderUnloadWarning() {\n    const { unloadWarning } = this.props;\n\n    if (!unloadWarning) {\n      return null;\n    }\n\n    const warnBeforePageUnload = typeof unloadWarning === 'object' ? unloadWarning.page : true;\n    const warnBeforeRouteTransition = typeof unloadWarning === 'object' ? unloadWarning.router : false;\n\n    const { unloadWarningEnabled: enabled } = this.state;\n\n    return (\n      <LeaveWarningPrompt\n        enabled={enabled}\n        warnBeforePageUnload={warnBeforePageUnload}\n        warnBeforeRouteTransition={warnBeforeRouteTransition}\n      />\n    );\n  }\n\n  render() {\n    const { lang, classNames: propsClassNames, components, role } = this.props;\n\n    const { labels, submitted } = this.state;\n\n    const values = this.get('values');\n    const loading = this.get('loading');\n    const errors = this.get('errors', []);\n\n    log('rendering', { values, errors });\n\n    const { clean: cleanValues } = this.sanitize(values, {\n      draft: true,\n    });\n\n    if (submitted) {\n      return (\n        <div className=\"text-center\">\n          <div className=\"padding-all-sm\">\n            <span>{labels.main.confirmation}</span>\n          </div>\n          <button\n            type=\"submit\"\n            className=\"btn btn-primary\"\n            onClick={this.onSubmitConfirm}\n          >\n            {labels.main.done}\n          </button>\n          {this.renderUnloadWarning()}\n        </div>\n      );\n    }\n\n    const formSchema = this._getFormSchema();\n\n    return (\n      <div className=\"oa-form\">\n        <div className={_.get(propsClassNames, 'fieldsCanvas', '')}>\n          {formSchema\n            .getFields()\n            .filter(isItemDisplayed.bind(null, role))\n            .map((f) => {\n              if (f.type === 'section') {\n                return <Section lang={lang} section={f} />;\n              }\n\n              return (\n                <Field\n                  disabled={loading}\n                  className={_.get(propsClassNames, 'field', 'form-group')}\n                  customComponents={components}\n                  lang={lang}\n                  labels={labels.main}\n                  type={f.fieldType}\n                  key={`field${f.field}`}\n                  field={f}\n                  value={_.get(values, f.field, null)}\n                  relatedValues={_.pick(\n                    cleanValues === null ? values : cleanValues,\n                    formSchema.getRelatedFields(f).map((rf) => rf.field),\n                  )}\n                  error={\n                    errors.filter((e) => e.field === f.field).shift()?.label\n                  }\n                  onChange={(value, files) =>\n                    this.onChange(f.field, value, files)}\n                  role={role}\n                />\n              );\n            })}\n        </div>\n        {this.renderGroupedErrors()}\n        {this.renderBottomActions()}\n        {this.renderUnloadWarning()}\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}