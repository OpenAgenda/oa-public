{"version":3,"file":"buildFieldSchema.js","names":["optionedTypes","minMaxedTypes","buildFieldSchema","type","_context","options","arguments","length","undefined","defaultLabelLanguage","isMultilingual","requireLabels","labelFieldType","structure","field","optional","max","label","defaultLanguage","help","default","helpLink","helpContent","info","sub","placeholder","write","list","read","display","enable","origin","unique","enableWith","optionalWith","allowNull","related","other","constraints","selfHandled","_includesInstanceProperty","call","Object","assign","min","extensions","store","allowURL","allowPath","imageWithSizeAndVariants","fields","id","value"],"sources":["../../src/iso/buildFieldSchema.js"],"sourcesContent":["import { optionedTypes, minMaxedTypes } from './fieldTypes.js';\n\nexport default function buildFieldSchema(type, options = {}) {\n  const {\n    defaultLabelLanguage = null,\n    isMultilingual = true,\n    requireLabels = true,\n  } = options;\n\n  const labelFieldType = isMultilingual || defaultLabelLanguage ? 'multilingual' : 'text';\n\n  const structure = {\n    // all custom schema fields must have a field name\n    // that is the name that will be used for the input\n    // in the form as well as the key in data exports\n    field: {\n      type: 'text',\n      optional: false,\n      max: 255,\n    },\n\n    // the label to be displayed in the form\n    label: {\n      type: labelFieldType,\n      optional: !requireLabels,\n      defaultLanguage: defaultLabelLanguage,\n    },\n\n    // the optional help text\n    help: {\n      type: labelFieldType,\n      optional: true,\n      default: null,\n      defaultLanguage: defaultLabelLanguage,\n    },\n\n    helpLink: {\n      type: 'link',\n      optional: true,\n      default: null,\n    },\n\n    helpContent: {\n      type: 'text',\n      optional: true,\n      default: null,\n    },\n\n    default: {\n      type: 'pass', // dependent on type of field\n      optional: true,\n    },\n\n    // an informative text can be added adjacent to the form item\n    info: {\n      type: labelFieldType,\n      max: 1000,\n      optional: true,\n      default: null,\n      defaultLanguage: defaultLabelLanguage,\n    },\n\n    sub: {\n      type: labelFieldType,\n      optional: true,\n      default: null,\n      defaultLanguage: defaultLabelLanguage,\n    },\n\n    placeholder: {\n      type: labelFieldType,\n      max: 400,\n      optional: true,\n      default: null,\n      defaultLanguage: defaultLabelLanguage,\n    },\n\n    write: {\n      type: 'text',\n      optional: true,\n      list: { default: null },\n    },\n\n    read: {\n      type: 'text',\n      optional: true,\n      list: { default: null },\n    },\n\n    optional: {\n      type: 'boolean',\n    },\n\n    display: {\n      type: 'pass',\n      default: true,\n    },\n\n    enable: {\n      type: 'boolean',\n      default: true,\n    },\n\n    // when the field was defined elsewhere (tag, category or custom)\n    origin: {\n      type: 'choice',\n      default: null,\n      unique: true,\n      options: ['tags', 'categories', 'custom'],\n    },\n\n    // other field that defines if this field should be enabled\n    enableWith: {\n      type: 'pass',\n      default: null,\n    },\n\n    optionalWith: {\n      type: 'pass',\n      default: null,\n    },\n\n    allowNull: {\n      type: 'boolean',\n      optional: true,\n      default: undefined,\n    },\n\n    related: {\n      enable: {\n        type: 'text',\n        default: [],\n        list: true,\n      },\n      optional: {\n        type: 'text',\n        default: [],\n        list: true,\n      },\n      other: {\n        type: 'text',\n        default: [],\n        list: true,\n      },\n    },\n\n    constraints: {\n      type: 'pass',\n      optional: true,\n    },\n\n    selfHandled: {\n      type: 'choice',\n      optional: true,\n      options: ['label', 'help', 'max', 'info', 'sub'],\n    },\n  };\n\n  if (minMaxedTypes.includes(type)) {\n    Object.assign(structure, {\n      min: {\n        type: 'integer',\n        optional: true,\n        default: null,\n      },\n      max: {\n        type: 'integer',\n        optional: true,\n        default: null,\n      },\n    });\n  }\n\n  if (['image', 'file'].includes(type)) {\n    Object.assign(structure, {\n      extensions: {\n        type: 'text',\n        optional: true,\n        list: true,\n      },\n      store: {\n        // store variables depend on type (s3 needs a region and a bucket)\n        type: 'pass',\n        optional: true,\n      },\n      allowURL: {\n        type: 'boolean',\n        optional: true,\n        default: false,\n      },\n      allowPath: {\n        type: 'boolean',\n        optional: true,\n        default: false,\n      },\n      imageWithSizeAndVariants: {\n        type: 'boolean',\n        optional: true,\n        default: false,\n      },\n    });\n  }\n\n  if (optionedTypes.includes(type)) {\n    Object.assign(structure, {\n      options: {\n        list: {\n          min: 1,\n        },\n        fields: {\n          id: {\n            type: 'integer',\n          },\n          value: {\n            type: 'text',\n            optional: false,\n          },\n          label: {\n            type: labelFieldType,\n            optional: false,\n            defaultLanguage: defaultLabelLanguage,\n          },\n          info: {\n            type: labelFieldType,\n            optional: true,\n            default: null,\n            defaultLanguage: defaultLabelLanguage,\n          },\n          display: {\n            type: 'pass',\n            default: true,\n          },\n        },\n      },\n    });\n  }\n\n  return structure;\n}\n"],"mappings":"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","ignoreList":[]}