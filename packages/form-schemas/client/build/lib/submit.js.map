{"version":3,"file":"submit.js","names":["sa","_ref","res","values","files","query","method","hasFiles","_keys","length","req","_get","window","ok","response","status","_isObject","send","data","JSON","stringify","forEach","fieldName","concat","file","index","Error","attach","field","_Promise","rs","rj","end","err"],"sources":["../../src/lib/submit.js"],"sourcesContent":["import _ from 'lodash';\nimport sa from 'superagent';\n\nexport default ({ res, values, files, query, method }) => {\n  const hasFiles = _.keys(files).length;\n\n  // IE11 does not like empty strings;\n  const req = sa[method || 'post'](res || _.get(window, 'location.href'));\n\n  req.ok((response) => response.status < 500);\n\n  if (_.isObject(query)) {\n    req.query(query);\n  }\n\n  if (!hasFiles) {\n    return req.send({\n      data: JSON.stringify(values),\n    });\n  }\n\n  _.keys(files).forEach((fieldName) => {\n    // handle multiple files if need be\n    [].concat(files[fieldName]).forEach((file, index) => {\n      if (!files[fieldName]) throw new Error(`file field is not defined: ${fieldName}`);\n\n      req.attach(fieldName, files[fieldName][index]);\n    });\n  });\n\n  req.field('data', JSON.stringify(values));\n\n  return new Promise((rs, rj) => {\n    req.end((err, response) => (err ? rj(err) : rs(response)));\n  });\n};\n"],"mappings":";;;;;;AACA,OAAOA,EAAE,MAAM,YAAY;AAE3B,eAAeC,IAAA,IAA2C;EAAA,IAA1C;IAAEC,GAAG;IAAEC,MAAM;IAAEC,KAAK;IAAEC,KAAK;IAAEC;EAAO,CAAC,GAAAL,IAAA;EACnD,MAAMM,QAAQ,GAAGC,KAAA,CAAOJ,KAAK,CAAC,CAACK,MAAM;;EAErC;EACA,MAAMC,GAAG,GAAGV,EAAE,CAACM,MAAM,IAAI,MAAM,CAAC,CAACJ,GAAG,IAAIS,IAAA,CAAMC,MAAM,EAAE,eAAe,CAAC,CAAC;EAEvEF,GAAG,CAACG,EAAE,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,MAAM,GAAG,GAAG,CAAC;EAE3C,IAAIC,SAAA,CAAWX,KAAK,CAAC,EAAE;IACrBK,GAAG,CAACL,KAAK,CAACA,KAAK,CAAC;EAClB;EAEA,IAAI,CAACE,QAAQ,EAAE;IACb,OAAOG,GAAG,CAACO,IAAI,CAAC;MACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACjB,MAAM;IAC7B,CAAC,CAAC;EACJ;EAEAK,KAAA,CAAOJ,KAAK,CAAC,CAACiB,OAAO,CAAEC,SAAS,IAAK;IACnC;IACA,EAAE,CAACC,MAAM,CAACnB,KAAK,CAACkB,SAAS,CAAC,CAAC,CAACD,OAAO,CAAC,CAACG,IAAI,EAAEC,KAAK,KAAK;MACnD,IAAI,CAACrB,KAAK,CAACkB,SAAS,CAAC,EAAE,MAAM,IAAII,KAAK,+BAAAH,MAAA,CAA+BD,SAAS,CAAE,CAAC;MAEjFZ,GAAG,CAACiB,MAAM,CAACL,SAAS,EAAElB,KAAK,CAACkB,SAAS,CAAC,CAACG,KAAK,CAAC,CAAC;IAChD,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFf,GAAG,CAACkB,KAAK,CAAC,MAAM,EAAET,IAAI,CAACC,SAAS,CAACjB,MAAM,CAAC,CAAC;EAEzC,OAAO,IAAA0B,QAAA,CAAY,CAACC,EAAE,EAAEC,EAAE,KAAK;IAC7BrB,GAAG,CAACsB,GAAG,CAAC,CAACC,GAAG,EAAEnB,QAAQ,KAAMmB,GAAG,GAAGF,EAAE,CAACE,GAAG,CAAC,GAAGH,EAAE,CAAChB,QAAQ,CAAE,CAAC;EAC5D,CAAC,CAAC;AACJ,CAAC","ignoreList":[]}