{"version":3,"file":"isFieldOptional.js","names":["debug","getWithFieldName","log","field","values","optional","optionalWith","relatedFieldValue","_get","optionalWithHasValue","relatedFieldValues","concat","value","filter","v","_includesInstanceProperty","call","length","Array","isArray"],"sources":["../../src/lib/isFieldOptional.js"],"sourcesContent":["import _ from 'lodash';\nimport debug from 'debug';\nimport getWithFieldName from '../iso/getWithFieldName.js';\n\nconst log = debug('isFieldOptional');\n\nexport default (field, values) => {\n  if (typeof field.optional === 'boolean') {\n    return field.optional;\n  }\n\n  if (!field.optionalWith) return true;\n\n  const relatedFieldValue = _.get(values, getWithFieldName(field.optionalWith));\n  const optionalWithHasValue = typeof field.optionalWith === 'object';\n\n  log(\n    'optionalWith is defined %s value',\n    optionalWithHasValue ? 'with' : 'without',\n  );\n\n  if (optionalWithHasValue) {\n    const relatedFieldValues = [].concat(relatedFieldValue);\n    return !![]\n      .concat(field.optionalWith.value)\n      .filter((v) => relatedFieldValues.includes(v)).length;\n  }\n\n  return !!(Array.isArray(relatedFieldValue)\n    ? relatedFieldValue.length\n    : relatedFieldValue);\n};\n"],"mappings":";;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,gBAAgB,MAAM,4BAA4B;AAEzD,MAAMC,GAAG,GAAGF,KAAK,CAAC,iBAAiB,CAAC;AAEpC,eAAe,CAACG,KAAK,EAAEC,MAAM,KAAK;EAChC,IAAI,OAAOD,KAAK,CAACE,QAAQ,KAAK,SAAS,EAAE;IACvC,OAAOF,KAAK,CAACE,QAAQ;EACvB;EAEA,IAAI,CAACF,KAAK,CAACG,YAAY,EAAE,OAAO,IAAI;EAEpC,MAAMC,iBAAiB,GAAGC,IAAA,CAAMJ,MAAM,EAAEH,gBAAgB,CAACE,KAAK,CAACG,YAAY,CAAC,CAAC;EAC7E,MAAMG,oBAAoB,GAAG,OAAON,KAAK,CAACG,YAAY,KAAK,QAAQ;EAEnEJ,GAAG,CACD,kCAAkC,EAClCO,oBAAoB,GAAG,MAAM,GAAG,SAClC,CAAC;EAED,IAAIA,oBAAoB,EAAE;IACxB,MAAMC,kBAAkB,GAAG,EAAE,CAACC,MAAM,CAACJ,iBAAiB,CAAC;IACvD,OAAO,CAAC,CAAC,EAAE,CACRI,MAAM,CAACR,KAAK,CAACG,YAAY,CAACM,KAAK,CAAC,CAChCC,MAAM,CAAEC,CAAC,IAAKC,yBAAA,CAAAL,kBAAkB,EAAAM,IAAA,CAAlBN,kBAAkB,EAAUI,CAAC,CAAC,CAAC,CAACG,MAAM;EACzD;EAEA,OAAO,CAAC,EAAEC,KAAK,CAACC,OAAO,CAACZ,iBAAiB,CAAC,GACtCA,iBAAiB,CAACU,MAAM,GACxBV,iBAAiB,CAAC;AACxB,CAAC","ignoreList":[]}