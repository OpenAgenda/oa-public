{"version":3,"file":"text.js","names":["_listify","_interopRequireDefault","require","_params","_errors","_default","config","params","cleanParams","field","min","max","trim","optional","default","list","strict","emptyStringAsUndefined","validate","value","_context","clean","_includes","undefined","call","concat","errors","_trim","length","_context2","values","validator","Object","assign","type","listify","exports","module"],"sources":["src/text.js"],"sourcesContent":["import listify from './listify';\nimport cleanParams from './lib/params';\nimport errors from './lib/errors';\n\nexport default config => {\n  const params = cleanParams('text', config, {\n    field: false, // required\n    min: 0,\n    max: 1000000,\n    trim: true,\n    optional: true,\n    default: null,\n    list: false,\n    strict: false,\n    emptyStringAsUndefined : true,\n  }, config || {});\n\n  const validate = value => {\n    let clean = [undefined, null].includes(value) ? '' : `${value}`;\n\n    if (typeof value === 'object' && clean) {\n      throw errors(params, value, 'string.invalidtype', 'not a string');\n    }\n\n    if (value !== undefined && typeof value !== 'string' && params.strict) {\n      throw errors(params, value, 'string.invalidtype', 'not a string');\n    }\n\n    if (params.trim) {\n      clean = clean.trim();\n    }\n\n    if (value === undefined || value === null ||\n      (!clean.length && params.emptyStringAsUndefined )) {\n      if (params.optional || ![undefined, null].includes(params.default)) {\n        return params.default;\n      }\n      throw errors(params, value, 'required', 'a string is required');\n    }\n\n    if (clean.length < params.min) {\n      throw errors(\n        params,\n        value,\n        'string.tooshort',\n        'the string is too short',\n        {\n          values: {\n            min: params.min,\n            max: params.max\n          }\n        }\n      );\n    }\n\n    if (clean.length > params.max) {\n      throw errors(\n        params,\n        value,\n        'string.toolong',\n        'the string is too long',\n        {\n          values: {\n            min: params.min,\n            max: params.max\n          }\n        }\n      );\n    }\n\n    return clean;\n  };\n\n  const validator = Object.assign(validate, {\n    type: 'text',\n    field: params.field\n  });\n\n  return params.list ? listify(validator, params) : validator;\n};\n"],"mappings":"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","ignoreList":[]}