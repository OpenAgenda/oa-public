{"version":3,"file":"withFieldValueMatches.js","names":["_choice","_interopRequireDefault","require","withFieldValueMatches","fieldOptions","withKey","values","fields","_context","_fields$withField","withParams","_get2","default","withField","field","value","undefined","evaluateRefFieldAsTruthy","Array","length","_includes","call","options","choice","preClean","concat","filter","v","_context2","module","exports"],"sources":["../src/schema/withFieldValueMatches.js"],"sourcesContent":["import _ from 'lodash';\nimport choice from '../choice';\n\nexport default function withFieldValueMatches(fieldOptions, withKey, values, fields) {\n  const withParams = _.get(fieldOptions, withKey);\n\n  const withField = typeof withParams === 'string' ? withParams : withParams.field;\n  const value = values === undefined ? undefined : values[withField];\n\n  const evaluateRefFieldAsTruthy = typeof withParams === 'string';\n\n  if (evaluateRefFieldAsTruthy && (value instanceof Array) && !value.length) {\n    return false;\n  }\n  if (evaluateRefFieldAsTruthy && [undefined, null, false].includes(value)) {\n    return false;\n  }\n  if (evaluateRefFieldAsTruthy) {\n    return true;\n  }\n\n  if (fields[withField]?.options) {\n    return !!choice.preClean({\n      options: [].concat(withParams.value)\n    }, value).length;\n    // return !!choice.preClean(fields[withField], withParams.value).length;\n  }\n\n  if (value instanceof Array) {\n    return value.includes(withParams.value);\n  }\n\n  return [].concat(value).filter(v => [].concat(withParams.value).includes(v)).length;\n}\n"],"mappings":";;;;;;;;;AACA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEe,SAASC,qBAAqBA,CAACC,YAAY,EAAEC,OAAO,EAAEC,MAAM,EAAEC,MAAM,EAAE;EAAA,IAAAC,QAAA,EAAAC,iBAAA;EACnF,MAAMC,UAAU,GAAG,IAAAC,KAAA,CAAAC,OAAA,EAAMR,YAAY,EAAEC,OAAO,CAAC;EAE/C,MAAMQ,SAAS,GAAG,OAAOH,UAAU,KAAK,QAAQ,GAAGA,UAAU,GAAGA,UAAU,CAACI,KAAK;EAChF,MAAMC,KAAK,GAAGT,MAAM,KAAKU,SAAS,GAAGA,SAAS,GAAGV,MAAM,CAACO,SAAS,CAAC;EAElE,MAAMI,wBAAwB,GAAG,OAAOP,UAAU,KAAK,QAAQ;EAE/D,IAAIO,wBAAwB,IAAKF,KAAK,YAAYG,KAAM,IAAI,CAACH,KAAK,CAACI,MAAM,EAAE;IACzE,OAAO,KAAK;EACd;EACA,IAAIF,wBAAwB,IAAI,IAAAG,SAAA,CAAAR,OAAA,EAAAJ,QAAA,IAACQ,SAAS,EAAE,IAAI,EAAE,KAAK,CAAC,EAAAK,IAAA,CAAAb,QAAA,EAAUO,KAAK,CAAC,EAAE;IACxE,OAAO,KAAK;EACd;EACA,IAAIE,wBAAwB,EAAE;IAC5B,OAAO,IAAI;EACb;EAEA,KAAAR,iBAAA,GAAIF,MAAM,CAACM,SAAS,CAAC,cAAAJ,iBAAA,eAAjBA,iBAAA,CAAmBa,OAAO,EAAE;IAC9B,OAAO,CAAC,CAACC,eAAM,CAACC,QAAQ,CAAC;MACvBF,OAAO,EAAE,EAAE,CAACG,MAAM,CAACf,UAAU,CAACK,KAAK;IACrC,CAAC,EAAEA,KAAK,CAAC,CAACI,MAAM;IAChB;EACF;EAEA,IAAIJ,KAAK,YAAYG,KAAK,EAAE;IAC1B,OAAO,IAAAE,SAAA,CAAAR,OAAA,EAAAG,KAAK,EAAAM,IAAA,CAALN,KAAK,EAAUL,UAAU,CAACK,KAAK,CAAC;EACzC;EAEA,OAAO,EAAE,CAACU,MAAM,CAACV,KAAK,CAAC,CAACW,MAAM,CAACC,CAAC;IAAA,IAAAC,SAAA;IAAA,OAAI,IAAAR,SAAA,CAAAR,OAAA,EAAAgB,SAAA,KAAE,CAACH,MAAM,CAACf,UAAU,CAACK,KAAK,CAAC,EAAAM,IAAA,CAAAO,SAAA,EAAUD,CAAC,CAAC;EAAA,EAAC,CAACR,MAAM;AACrF;AAACU,MAAA,CAAAC,OAAA,GAAAA,OAAA,CAAAlB,OAAA","ignoreList":[]}