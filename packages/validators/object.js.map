{"version":3,"file":"object.js","names":["_listify","_interopRequireDefault","require","object","options","arguments","length","undefined","validators","params","_objectSpread2","default","field","list","validate","values","errors","clean","forEach","validator","matchingValue","filter","v","value","type","push","caughtErrors","concat","error","origin","code","message","map","c","cleanItem","Object","assign","listify","module","exports"],"sources":["src/object.js"],"sourcesContent":["import listify from './listify';\n\nexport default function object(...args) {\n  const options = args.length === 1 ? {} : args[0];\n  const validators = args.length === 1 ? args[0] : args[1];\n\n  const params = {\n    field: null,\n    list: false,\n    ...options,\n  };\n\n  const validate = (values) => {\n    const errors = [];\n    const clean = [];\n\n    validators.forEach((validator) => {\n      let matchingValue = (values || []).filter((v) => v.field === validator.field);\n\n      matchingValue = matchingValue.length ? matchingValue[0] : {\n        field: validator.field,\n        value: validator.type === 'object' ? [] : undefined,\n      };\n\n      if (validator.type !== 'object') {\n        try {\n          clean.push({\n            field: matchingValue.field,\n            value: validator(matchingValue.value),\n          });\n        } catch (caughtErrors) {\n          [].concat(caughtErrors).forEach((error) => errors.push(error));\n        }\n      } else if (typeof matchingValue.value !== 'object') {\n        errors.push([{\n          field: matchingValue.field,\n          origin: matchingValue.value,\n          code: 'object.invalidtype',\n          message: 'not an object',\n        }]);\n      } else {\n        try {\n          validator(matchingValue.value).map((c) => ({\n            ...c,\n            field: `${matchingValue.field}.${c.field}`,\n          })).forEach((cleanItem) => {\n            clean.push(cleanItem);\n          });\n        } catch (caughtErrors) {\n          caughtErrors.forEach((error) => {\n            errors.push({\n              ...error,\n              field: `${matchingValue.field}.${error.field}`,\n            });\n          });\n        }\n      }\n    });\n\n    if (errors.length) {\n      throw errors;\n    }\n\n    return clean;\n  };\n\n  const validator = Object.assign(validate, {\n    type: 'object',\n    field: params.field,\n  });\n\n  return params.list ? listify(validator) : validator;\n}\n"],"mappings":"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","ignoreList":[]}