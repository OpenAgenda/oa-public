{"version":3,"sources":["../../../src/components/fields/SearchInput.js","../../../src/contexts/FiltersAndWidgetsContext.js"],"sourcesContent":["import React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { useForm } from 'react-final-form';\nimport { useDebouncedCallback } from 'use-debounce';\nimport { defineMessages, useIntl } from 'react-intl';\nimport FiltersAndWidgetsContext from '../../contexts/FiltersAndWidgetsContext.js';\n\nconst messages = defineMessages({\n  ariaLabel: {\n    id: 'ReactFilters.components.fields.SearchInput.ariaLabel',\n    defaultMessage: 'Search',\n  },\n});\n\nfunction Input({ input, placeholder, ariaLabel, onButtonClick, manualSubmit }) {\n  const intl = useIntl();\n\n  return (\n    <div className=\"input-group mb-3\">\n      <input\n        className=\"form-control\"\n        autoComplete=\"off\"\n        placeholder={placeholder}\n        aria-label={ariaLabel}\n        title={ariaLabel}\n        {...input}\n      />\n      {!manualSubmit ? (\n        <div className=\"input-group-append\">\n          <button\n            type=\"submit\"\n            className=\"btn btn-outline-secondary\"\n            onClick={onButtonClick}\n            aria-label={intl.formatMessage(messages.ariaLabel)}\n          >\n            <i className=\"fa fa-search\" aria-hidden=\"true\" />\n          </button>\n        </div>\n      ) : null}\n    </div>\n  );\n}\n\nexport default function SearchInput({\n  inputComponent = Input,\n  input,\n  onChange, // user onChange\n  manualSearch,\n  ...rest\n}) {\n  const form = useForm();\n  const [tmpValue, setTmpValue] = useState(input.value);\n\n  const {\n    filtersOptions: { manualSubmit },\n  } = useContext(FiltersAndWidgetsContext);\n\n  const debouncedOnChange = useDebouncedCallback((e) => {\n    if (manualSearch) {\n      return;\n    }\n\n    input.onChange(e);\n    if (typeof onChange === 'function') {\n      onChange(e.target.value);\n    }\n  }, 400);\n\n  const inputOnChange = useCallback(\n    (e) => {\n      e.persist();\n\n      setTmpValue(e.target.value);\n      debouncedOnChange(e);\n      // direct call with manualSubmit\n      if (manualSubmit) {\n        debouncedOnChange.flush();\n      }\n    },\n    [debouncedOnChange],\n  );\n\n  const onButtonClick = useCallback(\n    (e) => {\n      e.preventDefault();\n      if (manualSearch) {\n        input.onChange(tmpValue);\n        if (typeof onChange === 'function') {\n          onChange(tmpValue);\n        }\n      }\n      return form.submit();\n    },\n    [form, input, manualSearch, onChange, tmpValue],\n  );\n\n  const wrappedInput = useMemo(\n    () => ({\n      ...input,\n      value: tmpValue,\n      onChange: inputOnChange,\n    }),\n    [input, inputOnChange, tmpValue],\n  );\n\n  useEffect(() => {\n    setTmpValue(input.value);\n  }, [input.value]);\n\n  return React.createElement(inputComponent, {\n    input: wrappedInput,\n    onButtonClick,\n    manualSubmit,\n    ...rest,\n  });\n}\n","import { createContext } from 'react';\n\nconst FiltersAndWidgetsContext = createContext({\n  filters: [],\n  widgets: [],\n  setFilters: () => {},\n  setWidgets: () => {},\n  filtersOptions: {},\n});\n\nexport default FiltersAndWidgetsContext;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAAA,gBAMO;AACP,8BAAwB;AACxB,0BAAqC;AACrC,wBAAwC;;;ACTxC,mBAA8B;AAE9B,IAAM,+BAA2B,4BAAc;AAAA,EAC7C,SAAS,CAAC;AAAA,EACV,SAAS,CAAC;AAAA,EACV,YAAY,MAAM;AAAA,EAAC;AAAA,EACnB,YAAY,MAAM;AAAA,EAAC;AAAA,EACnB,gBAAgB,CAAC;AACnB,CAAC;AAED,IAAO,mCAAQ;;;ADaX;AAXJ,IAAM,eAAW,kCAAe;AAAA,EAC9B,WAAW;AAAA,IACT,IAAI;AAAA,IACJ,gBAAgB;AAAA,EAClB;AACF,CAAC;AAED,SAAS,MAAM,EAAE,OAAO,aAAa,WAAW,eAAe,aAAa,GAAG;AAC7E,QAAM,WAAO,2BAAQ;AAErB,SACE,6CAAC,SAAI,WAAU,oBACb;AAAA;AAAA,MAAC;AAAA;AAAA,QACC,WAAU;AAAA,QACV,cAAa;AAAA,QACb;AAAA,QACA,cAAY;AAAA,QACZ,OAAO;AAAA,QACN,GAAG;AAAA;AAAA,IACN;AAAA,IACC,CAAC,eACA,4CAAC,SAAI,WAAU,sBACb;AAAA,MAAC;AAAA;AAAA,QACC,MAAK;AAAA,QACL,WAAU;AAAA,QACV,SAAS;AAAA,QACT,cAAY,KAAK,cAAc,SAAS,SAAS;AAAA,QAEjD,sDAAC,OAAE,WAAU,gBAAe,eAAY,QAAO;AAAA;AAAA,IACjD,GACF,IACE;AAAA,KACN;AAEJ;AAEe,SAAR,YAA6B;AAAA,EAClC,iBAAiB;AAAA,EACjB;AAAA,EACA;AAAA;AAAA,EACA;AAAA,EACA,GAAG;AACL,GAAG;AACD,QAAM,WAAO,iCAAQ;AACrB,QAAM,CAAC,UAAU,WAAW,QAAI,wBAAS,MAAM,KAAK;AAEpD,QAAM;AAAA,IACJ,gBAAgB,EAAE,aAAa;AAAA,EACjC,QAAI,0BAAW,gCAAwB;AAEvC,QAAM,wBAAoB,0CAAqB,CAAC,MAAM;AACpD,QAAI,cAAc;AAChB;AAAA,IACF;AAEA,UAAM,SAAS,CAAC;AAChB,QAAI,OAAO,aAAa,YAAY;AAClC,eAAS,EAAE,OAAO,KAAK;AAAA,IACzB;AAAA,EACF,GAAG,GAAG;AAEN,QAAM,oBAAgB;AAAA,IACpB,CAAC,MAAM;AACL,QAAE,QAAQ;AAEV,kBAAY,EAAE,OAAO,KAAK;AAC1B,wBAAkB,CAAC;AAEnB,UAAI,cAAc;AAChB,0BAAkB,MAAM;AAAA,MAC1B;AAAA,IACF;AAAA,IACA,CAAC,iBAAiB;AAAA,EACpB;AAEA,QAAM,oBAAgB;AAAA,IACpB,CAAC,MAAM;AACL,QAAE,eAAe;AACjB,UAAI,cAAc;AAChB,cAAM,SAAS,QAAQ;AACvB,YAAI,OAAO,aAAa,YAAY;AAClC,mBAAS,QAAQ;AAAA,QACnB;AAAA,MACF;AACA,aAAO,KAAK,OAAO;AAAA,IACrB;AAAA,IACA,CAAC,MAAM,OAAO,cAAc,UAAU,QAAQ;AAAA,EAChD;AAEA,QAAM,mBAAe;AAAA,IACnB,OAAO;AAAA,MACL,GAAG;AAAA,MACH,OAAO;AAAA,MACP,UAAU;AAAA,IACZ;AAAA,IACA,CAAC,OAAO,eAAe,QAAQ;AAAA,EACjC;AAEA,+BAAU,MAAM;AACd,gBAAY,MAAM,KAAK;AAAA,EACzB,GAAG,CAAC,MAAM,KAAK,CAAC;AAEhB,SAAO,cAAAC,QAAM,cAAc,gBAAgB;AAAA,IACzC,OAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA,GAAG;AAAA,EACL,CAAC;AACH;","names":["import_react","React"]}