{"version":3,"sources":["../src/components/filters/NumberRangeFilter.js"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { Field, useField } from 'react-final-form';\nimport NumberRangeField from '../fields/NumberRangeField.js';\nimport Panel from '../Panel.js';\nimport Title from '../Title.js';\nimport FilterPreviewer from '../FilterPreviewer.js';\n\nconst subscription = { value: true };\n\nconst isDefined = (v) => ![undefined, null, ''].includes(v);\n\nfunction formatPreviewLabel(value) {\n  if (!isDefined(value.gte) && isDefined(value.lte)) {\n    return `≤ ${value.lte}`;\n  }\n\n  if (isDefined(value.gte) && !isDefined(value.lte)) {\n    return `≥ ${value.gte}`;\n  }\n\n  if (isDefined(value.gte) && isDefined(value.lte)) {\n    return `${value.gte} ≤ ${value.lte}`;\n  }\n}\n\nfunction parseValue(value) {\n  const definedLte = isDefined(value?.lte);\n  const definedGte = isDefined(value?.gte);\n\n  if (!definedLte && !definedGte) {\n    return undefined;\n  }\n\n  const result = {};\n\n  if (definedLte) result.lte = value.lte;\n  if (definedGte) result.gte = value.gte;\n\n  return result;\n}\n\nfunction Preview({ name, component = FilterPreviewer, disabled, ...rest }) {\n  const { input } = useField(name, { subscription });\n\n  const onRemove = useCallback(\n    (e) => {\n      e.stopPropagation();\n\n      if (disabled) {\n        return;\n      }\n\n      input.onChange(undefined);\n    },\n    [input, disabled],\n  );\n\n  if (!input.value?.gte && !input.value?.lte) {\n    return null;\n  }\n\n  return React.createElement(component, {\n    name,\n    label: formatPreviewLabel(input.value),\n    onRemove,\n    disabled,\n    ...rest,\n  });\n}\n\nconst NumberRangeFilter = React.forwardRef(function NumberRangeFilter(\n  { name },\n  ref,\n) {\n  return (\n    <Field\n      ref={ref}\n      name={name}\n      subscription={subscription}\n      parse={parseValue}\n      component={NumberRangeField}\n    />\n  );\n});\n\nconst Collapsable = React.forwardRef(function Collapsable(\n  { name, filter, component, disabled, ...rest },\n  ref,\n) {\n  const [collapsed, setCollapsed] = useState(true);\n\n  return (\n    <Panel\n      header={(\n        <Title\n          name={name}\n          filter={filter}\n          component={Preview}\n          disabled={disabled}\n        />\n      )}\n      collapsed={collapsed}\n      setCollapsed={setCollapsed}\n    >\n      <NumberRangeFilter\n        ref={ref}\n        name={name}\n        filter={filter}\n        component={component}\n        disabled={disabled}\n        collapsed={collapsed}\n        {...rest}\n      />\n    </Panel>\n  );\n});\n\nconst exported = React.memo(NumberRangeFilter);\n\nexported.Preview = Preview;\nexported.Collapsable = Collapsable;\n\nexport default exported;\n"],"mappings":";;;;;;;;;;;;;;AAAA,OAAO,SAAS,UAAU,mBAAmB;AAC7C,SAAS,OAAO,gBAAgB;AA0E5B;AApEJ,IAAM,eAAe,EAAE,OAAO,KAAK;AAEnC,IAAM,YAAY,CAAC,MAAM,CAAC,CAAC,QAAW,MAAM,EAAE,EAAE,SAAS,CAAC;AAE1D,SAAS,mBAAmB,OAAO;AACjC,MAAI,CAAC,UAAU,MAAM,GAAG,KAAK,UAAU,MAAM,GAAG,GAAG;AACjD,WAAO,UAAK,MAAM,GAAG;AAAA,EACvB;AAEA,MAAI,UAAU,MAAM,GAAG,KAAK,CAAC,UAAU,MAAM,GAAG,GAAG;AACjD,WAAO,UAAK,MAAM,GAAG;AAAA,EACvB;AAEA,MAAI,UAAU,MAAM,GAAG,KAAK,UAAU,MAAM,GAAG,GAAG;AAChD,WAAO,GAAG,MAAM,GAAG,WAAM,MAAM,GAAG;AAAA,EACpC;AACF;AAEA,SAAS,WAAW,OAAO;AACzB,QAAM,aAAa,UAAU,+BAAO,GAAG;AACvC,QAAM,aAAa,UAAU,+BAAO,GAAG;AAEvC,MAAI,CAAC,cAAc,CAAC,YAAY;AAC9B,WAAO;AAAA,EACT;AAEA,QAAM,SAAS,CAAC;AAEhB,MAAI,WAAY,QAAO,MAAM,MAAM;AACnC,MAAI,WAAY,QAAO,MAAM,MAAM;AAEnC,SAAO;AACT;AAEA,SAAS,QAAQ,EAAE,MAAM,YAAY,iBAAiB,UAAU,GAAG,KAAK,GAAG;AAzC3E;AA0CE,QAAM,EAAE,MAAM,IAAI,SAAS,MAAM,EAAE,aAAa,CAAC;AAEjD,QAAM,WAAW;AAAA,IACf,CAAC,MAAM;AACL,QAAE,gBAAgB;AAElB,UAAI,UAAU;AACZ;AAAA,MACF;AAEA,YAAM,SAAS,MAAS;AAAA,IAC1B;AAAA,IACA,CAAC,OAAO,QAAQ;AAAA,EAClB;AAEA,MAAI,GAAC,WAAM,UAAN,mBAAa,QAAO,GAAC,WAAM,UAAN,mBAAa,MAAK;AAC1C,WAAO;AAAA,EACT;AAEA,SAAO,MAAM,cAAc,WAAW;AAAA,IACpC;AAAA,IACA,OAAO,mBAAmB,MAAM,KAAK;AAAA,IACrC;AAAA,IACA;AAAA,IACA,GAAG;AAAA,EACL,CAAC;AACH;AAEA,IAAM,oBAAoB,MAAM,WAAW,SAASA,mBAClD,EAAE,KAAK,GACP,KACA;AACA,SACE;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA,MACA,OAAO;AAAA,MACP,WAAW;AAAA;AAAA,EACb;AAEJ,CAAC;AAED,IAAM,cAAc,MAAM,WAAW,SAASC,aAC5C,EAAE,MAAM,QAAQ,WAAW,UAAU,GAAG,KAAK,GAC7C,KACA;AACA,QAAM,CAAC,WAAW,YAAY,IAAI,SAAS,IAAI;AAE/C,SACE;AAAA,IAAC;AAAA;AAAA,MACC,QACE;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UACA;AAAA,UACA,WAAW;AAAA,UACX;AAAA;AAAA,MACF;AAAA,MAEF;AAAA,MACA;AAAA,MAEA;AAAA,QAAC;AAAA;AAAA,UACC;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACC,GAAG;AAAA;AAAA,MACN;AAAA;AAAA,EACF;AAEJ,CAAC;AAED,IAAM,WAAW,MAAM,KAAK,iBAAiB;AAE7C,SAAS,UAAU;AACnB,SAAS,cAAc;AAEvB,IAAO,4BAAQ;","names":["NumberRangeFilter","Collapsable"]}